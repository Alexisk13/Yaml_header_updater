for file in $files
do 
  echo "Checking file: $file"

  if grep -q "\$LastChangedRevision:" "$file"; then
    if grep -qE '^-{77,}' "$file"; then
      echo "File contains the header, processing..."

      VERSION=$(grep '\$LastChangedRevision:' "$file" | sed -n 's/^-- *\$LastChangedRevision: *\([0-9]\+\).*/\1/p')

      if [ -z "$VERSION" ]; then
        echo "No version found in the header, skipping file."
        continue
      fi

      NEW_VERSION=$((VERSION + 1))
      echo "Incrementing version: $VERSION -> $NEW_VERSION"

      HEADER="-----------------------------------------------------------------------------
-- Version
--   \$LastChangedRevision: $NEW_VERSION \$;
--
-- Date
--   \$LastChangedDate: $(date +"%Y-%m-%d %H:%M:%S %z (%a, %d %b %Y)") \$;
--
-- Author
--   \$LastChangedBy: 777 \$;
--
-----------------------------------------------------------------------------"

      sed -i '/^-\{77,\}/,/^-\{77,\}/d' "$file"  # Remove old header
      echo -e "$HEADER\n$(cat "$file")" > temp.sql && mv temp.sql "$file"  # Insert new header

      # Stage the file for commit
      git add "$file"
    else
      echo "Skipping file $file (missing separator)"
    fi
  fi
done

# Commit all chang